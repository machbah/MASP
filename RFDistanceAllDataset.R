library(phangorn)
library(phylogram)
library(phytools)
library(purrr)

u1 <- c('((NC_009060:0.013311,(NC_009059:0.011325,NC_009066:0.011325):0.0019861):0.0058929,((NC_010205:0.010725,(NC_009067:0.0071595,NC_012055:0.0071595):0.0035651):0.0076208,(((((NC_009459:0.008526,NC_011179:0.008526):0.0020714,(NC_011169:0.0097746,(NC_011171:0.0078074,NC_011177:0.0078074):0.0019673):0.00082278):0.00089275,((NC_009057:0.0074998,NC_013663:0.0074998):0.0031927,(NC_013750:0.0086149,(NC_009062:0.007977,(NC_018814:0.0068233,(NC_009063:0.0058321,NC_018815:0.0058321):0.00099119):0.0011537):0.00063784):0.0020777):0.00079762):0.0018924,(NC_009058:0.012715,(NC_011168:0.010161,NC_011170:0.010161):0.0025537):0.000668):0.0030249,(NC_013577:0.014551,(NC_013564:0.010789,(NC_009064:0.0081737,NC_009065:0.0081737):0.0026149):0.0037627):0.0018562):0.0019379):0.0008582);',
    '(NC_013577:0.013614,((NC_010205:0.010019,(NC_009067:0.0071595,NC_012055:0.0071595):0.0028595):0.0034096,(NC_009060:0.012632,(NC_009059:0.010563,(NC_013564:0.010519,(NC_009058:0.010467,(NC_009066:0.010399,(((NC_009064:0.0081737,NC_009065:0.0081737):0.0016755,((NC_009459:0.008526,NC_011179:0.008526):0.00083392,(NC_011169:0.0090019,((NC_011171:0.0078074,NC_011177:0.0078074):0.0008244,((NC_009062:0.0074649,(NC_018814:0.0062207,(NC_009063:0.0058321,NC_018815:0.0058321):0.00038854):0.0012442):0.00062207,(NC_013750:0.007664,(NC_009057:0.0074998,NC_013663:0.0074998):0.00016421):0.00042298):0.00054476):0.00037017):0.00035801):0.00048927):0.00031886,(NC_011168:0.010161,NC_011170:0.010161):7.1025e-06):0.00023104):6.8176e-05):5.1282e-05):4.4005e-05):0.0020693):0.00079686):0.00018494);',
    '((NC_009060:0.01399,(NC_009059:0.011325,NC_009066:0.011325):0.0026649):0.017972,((((NC_009057:0.0074998,NC_013663:0.0074998):0.0051817,((NC_018814:0.007426,(NC_009063:0.0058321,NC_018815:0.0058321):0.0015938):0.0018474,(NC_009062:0.008087,NC_013750:0.008087):0.0011864):0.0034081):0.0051622,(((NC_009459:0.008526,NC_011179:0.008526):0.003112,(NC_011169:0.01043,(NC_011171:0.0078074,NC_011177:0.0078074):0.0026226):0.001208):0.0032629,(NC_009058:0.013731,(NC_011168:0.010161,NC_011170:0.010161):0.0035705):0.0011695):0.0029428):0.0075499,((NC_010205:0.01143,(NC_009067:0.0071595,NC_012055:0.0071595):0.0042706):0.01061,(NC_013577:0.015859,(NC_013564:0.011059,(NC_009064:0.0081737,NC_009065:0.0081737):0.0028849):0.0048009):0.0061804):0.0033537):0.0065679);');

#my_data <- read.delim("newWickTree.txt");

fileName <- "newWickTree.txt"
conn <- file(fileName,open="r")
linn <-readLines(conn,skipNul = TRUE)

best<-1000;


for (i in 1:length(linn)){
  #print(linn[i])
  
  p<- linn[i];
  #get value from array, and trimws for removing space in each string
  z<- trimws(p);
  tree1<- read.tree(text=z);
  #Fish Benchmark from AFProject full genome sequence
 
  #reference Tree Fish
  tree2<- read.tree(text='((NC_013564,NC_013577),(((NC_009459,NC_009066),(NC_010205,(NC_012055,NC_009067))),(((NC_009060,NC_009059),(NC_009064,NC_009065)),((NC_011179,NC_011177),((NC_011170,NC_011169),((NC_011168,NC_009058),(NC_011171,((NC_009057,(NC_013750,NC_013663)),(NC_009062,(NC_018814,(NC_018815,NC_009063)))))))))));')
  
  #Reference Tree Ecoli
  #tree2<- read.tree(text='((((D1Sd197,(CB9615,(Sakai,EDL933))),(((((SSSs046,(B18BS512,B4Sb227)),(E24377A,(IAI1,SE11)))),(F5b8401,(F2a2457T,F2a301))),((ATCC8739,HS),((BW2952,DH10B),(MG1655,W3110))))),UMN026),((IAI39,SMS35),(E234869,(536,((S88,(APEC01,UTI89)),(ED1a,CFT073))))));')
  
  #Reference HGT 27 Ecoli/Shigella
  #tree2<- read.tree(text='((NC_011751,((NC_007606,(NC_002655,NC_002695)),(((NC_000913,NC_007779),(NC_009800,NC_010468)),((NC_008258,(NC_004337,NC_004741)),((NC_007384,(NC_007613,NC_010658)),(NC_009801,((NC_011415,NC_011741),NC_011748))))))),((((NC_008253,NC_004431),(NC_011745,(NC_007946,(NC_008563,NC_011742)))),NC_011601),(NC_010498,NC_011750)));')
  
  
  #Reference 8 Yersinia strains
  #tree2<- read.tree(text='(NC_009381:0.05427,(NC_004088:0.04271,(((BX936398:0.05436,(NC_003143:0.03868,NC_008150:0.04749):0.01295):0.01827,NC_005810:0.03773):0.00440,NC_008149:0.04275):0.00268):0.03011,AAKT020000:0.06606);')
  
  
  
  #Reference 16s Ribosomal
  #tree2<- read.tree(text='(((((NR_156072.1:0.01869823,(NR_134818.1:0.00744001,NR_134817.1:0.00744001):0.01125822):0.00411357,NR_152063.1:0.02281180):0.04482467,(((NR_148787.1:0.00210817,NR_148244.1:0.00210817):0.02309284,KP317497.2:0.02520101):0.00954158,NR_040849.1:0.03474259):0.03289388):0.06124202,J01859.1:0.12887849):0.00000000,((NR_136784.2:0.01793636,NR_132306.2:0.01793636):0.01321595,(NR_117152.1:0.02641772,NR_037066.1:0.02641772):0.00473459):0.12732391);')
  
  
  #Reference 18 eutherian mammal
  #tree2<- read.tree(text='(((((((X72004.1:0.01774238,X63726.1:0.01774238):0.08779836,U20753.1:0.10554074):0.00915521,(Y07726.1:0.08571134,X79547.1:0.08571134):0.02898461):0.01014793,(V00654.1:0.11236839,(X72204.1:0.03853818,X61145.1:0.03853818):0.07383021):0.01247549):0.04072994,(Y18001.1:0.11782902,(X99256.1:0.08714754,(D38115.1:0.07883038,(D38114.1:0.05308886,(V00662.1:0.04400841,(D38116.1:0.01884850,D38113.1:0.01884850):0.02515991):0.00908045):0.02574152):0.00831716):0.03068148):0.04774480):0.00920424,(X14848.1:0.09761302,V00711.1:0.09761302):0.07716504):0.00000000,X83427.1:0.23355953);')
  
  
  
  print(i);
  
  tBest<- RF.dist(tree1, tree2);
  if(tBest<best)
    best<-tBest;
  
  print(RF.dist(tree1, tree2));
  print(treedist(tree1, tree2));
  print(sprdist(tree1, tree2));
  print(SPR.dist(tree1, tree2));

}
close(conn);
print(best);
